// JavaScript autoComplete v1.0.0 beta
// https://github.com/Pixabay/JavaScript-autoComplete
var autoComplete=function(){function e(e){function t(e,t){return e.classList?e.classList.contains(t):new RegExp("\\b"+t+"\\b").test(e.className)}function o(e,t){if(document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent(t,!0,!0),e.dispatchEvent(o)}else{var o=document.createEventObject();o.eventType=t,e.fireEvent("on"+o.eventType,o)}}function s(e,t,o){e.attachEvent?e.attachEvent("on"+t,o):e.addEventListener(t,o)}function n(e,t,o){e.detachEvent?e.detachEvent("on"+t,o):e.removeEventListener(t,o)}function c(e,o,n,c){s(c||document,o,function(o){for(var s,c=o.target||o.srcElement;c&&!(s=t(c,e));)c=c.parentElement;s&&n.call(c,o)})}if(document.querySelector){var l={selector:0,source:0,minChars:3,delay:150,cache:1,menuClass:"",renderItem:function(e,t){var o=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(o,"<b>$1</b>")+"</div>"},onSelect:function(e,t,o){}};for(var a in e)e.hasOwnProperty(a)&&(l[a]=e[a]);for(var u="object"==typeof l.selector?[l.selector]:document.querySelectorAll(l.selector),i=0;i<u.length;i++){var r=u[i];r.sc=document.createElement("div"),r.sc.className="autocomplete-suggestions "+l.menuClass,r.setAttribute("data-sc",r.sc),r.autocompleteAttr=r.getAttribute("autocomplete"),r.setAttribute("autocomplete","off"),r.cache={},r.last_val="",r.updateSC=function(e,t){var o=r.getBoundingClientRect(),s=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,n=document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft;if(r.sc.style.left=o.left+n+"px",r.sc.style.top=o.bottom+s+1+"px",r.sc.style.width=o.right-o.left+"px",!e&&(r.sc.style.display="block",r.sc.maxHeight||(r.sc.maxHeight=parseInt((window.getComputedStyle?getComputedStyle(r.sc,null):r.sc.currentStyle).maxHeight)),r.sc.suggestionHeight||(r.sc.suggestionHeight=r.sc.querySelector(".autocomplete-suggestion").offsetHeight),r.sc.suggestionHeight))if(t){var c=r.sc.scrollTop,l=t.getBoundingClientRect().top-r.sc.getBoundingClientRect().top;l+r.sc.suggestionHeight-r.sc.maxHeight>0?r.sc.scrollTop=l+r.sc.suggestionHeight+c-r.sc.maxHeight:0>l&&(r.sc.scrollTop=l+c)}else r.sc.scrollTop=0},s(window,"resize",r.updateSC),document.body.appendChild(r.sc),c("autocomplete-suggestion","mouseleave",function(e){var t=r.sc.querySelector(".autocomplete-suggestion.selected");t&&setTimeout(function(){t.className=t.className.replace("selected","")},20)},r.sc),c("autocomplete-suggestion","mouseover",function(e){var t=r.sc.querySelector(".autocomplete-suggestion.selected");t&&(t.className=t.className.replace("selected","")),this.className+=" selected"},r.sc),c("autocomplete-suggestion","mouseup",function(e){if(t(this,"autocomplete-suggestion")){var o=this.getAttribute("data-val");r.value=o,l.onSelect(e,o,this),r.focus(),r.sc.style.display="none"}},r.sc),r.blurHandler=function(){try{var e=document.querySelector(".autocomplete-suggestions:hover")}catch(t){var e=0}e?r.focus():(r.last_val=r.value,r.sc.style.display="none")},s(r,"blur",r.blurHandler),r.focusHandler=function(){r.last_val="\n",o(r,"keyup")},l.minChars||s(r,"focus",r.focusHandler);var d=function(e){var t=r.value;if(r.cache[t]=e,e.length&&t.length>=l.minChars){for(var o="",s=0;s<e.length;s++)o+=l.renderItem(e[s],t);r.sc.innerHTML=o,r.updateSC(0)}else r.sc.style.display="none"};r.keydownHandler=function(e){var t=window.event?e.keyCode:e.which;if((40==t||38==t)&&r.sc.innerHTML){var o,s=r.sc.querySelector(".autocomplete-suggestion.selected");return s?(o=40==t?s.nextSibling:s.previousSibling,o?(s.className=s.className.replace("selected",""),o.className+=" selected",r.value=o.getAttribute("data-val")):(s.className=s.className.replace("selected",""),r.value=r.last_val,o=0)):(o=40==t?r.sc.querySelector(".autocomplete-suggestion"):r.sc.childNodes[r.sc.childNodes.length-1],o.className+=" selected",r.value=o.getAttribute("data-val")),r.updateSC(0,o),!1}if(27==t)r.value=r.last_val,r.sc.style.display="none";else if(13==t){var s=r.sc.querySelector(".autocomplete-suggestion.selected");s&&(l.onSelect(e,s.getAttribute("data-val"),s),setTimeout(function(){r.focus(),r.sc.style.display="none"},10))}},s(r,"keydown",r.keydownHandler),r.keyupHandler=function(e){var t=window.event?e.keyCode:e.which;if(27!=t&&38!=t&&40!=t&&37!=t&&39!=t){var o=r.value;if(o.length>=l.minChars){if(o!=r.last_val){if(r.last_val=o,clearTimeout(r.timer),l.cache){if(o in r.cache)return void d(r.cache[o]);for(var s=1;s<o.length-l.minChars;s++){var n=o.slice(0,o.length-s);if(n in r.cache&&!r.cache[n].length)return void d([])}}r.timer=setTimeout(function(){l.source(o,d)},l.delay)}}else r.last_val=o,r.sc.style.display="none"}},s(r,"keyup",r.keyupHandler)}this.destroy=function(){for(var e=0;e<u.length;e++){var t=u[e];n(window,"resize",t.updateSC),n(t,"blur",t.blurHandler),n(t,"focus",t.focusHandler),n(t,"keydown",t.keydownHandler),n(t,"keyup",t.keyupHandler),t.autocompleteAttr?t.setAttribute("autocomplete",t.autocompleteAttr):t.removeAttribute("autocomplete"),document.body.removeChild(t.sc),t=null}}}}return e}();!function(){"function"==typeof define&&define.amd?define("autoComplete",function(){return autoComplete}):"undefined"!=typeof module&&module.exports?module.exports=autoComplete:window.autoComplete=autoComplete}();