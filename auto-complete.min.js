// JavaScript autoComplete v1.0.0 beta
// https://github.com/Pixabay/JavaScript-autoComplete
var autoComplete=function(){function e(e){function t(e,t){if(document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent(t,!0,!0),e.dispatchEvent(o)}else{var o=document.createEventObject();o.eventType=t,e.fireEvent("on"+o.eventType,o)}}function o(e,t,o){e.addEventListener?e.addEventListener(t,o):e.attachEvent("on"+t,o)}function n(e,t,o){e.detachEvent?e.detachEvent("on"+t,o):e.removeEventListener(t,o)}function c(e,t,n,c){o(e,t,function(e){for(var t,o=e.target||e.srcElement;o&&!(t=~o.className.indexOf(n));)o=o.parentElement;t&&c.call(o,e)})}if(document.querySelector){var s={selector:0,source:0,minChars:3,delay:150,cache:1,menuClass:"",renderItem:function(e,t){var o=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(o,"<b>$1</b>")+"</div>"},onSelect:function(e,t,o){}};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(s[l]=e[l]);for(var a="object"==typeof s.selector?[s.selector]:document.querySelectorAll(s.selector),u=0;u<a.length;u++){var i=a[u];i.sc=document.createElement("div"),i.sc.className="autocomplete-suggestions "+s.menuClass,i.setAttribute("data-sc",i.sc),i.autocompleteAttr=i.getAttribute("autocomplete"),i.setAttribute("autocomplete","off"),i.cache={},i.last_val="",i.updateSC=function(e,t){var o=i.getBoundingClientRect(),n=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,c=document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft;if(i.sc.style.left=o.left+c+"px",i.sc.style.top=o.bottom+n+1+"px",i.sc.style.width=o.right-o.left+"px",!e){if(i.sc.style.display="block",i.sc.maxHeight||(i.sc.maxHeight=parseInt((window.getComputedStyle?getComputedStyle(i.sc,null):i.sc.currentStyle).maxHeight)),!i.sc.suggestionHeight){var s=i.sc.querySelector(".autocomplete-suggestion").getBoundingClientRect();i.sc.suggestionHeight=s.bottom-s.top}if(i.sc.suggestionHeight)if(t){var l=i.sc.scrollTop,a=t.getBoundingClientRect().top-i.sc.getBoundingClientRect().top;a+i.sc.suggestionHeight-i.sc.maxHeight>0?i.sc.scrollTop=a+i.sc.suggestionHeight+l-i.sc.maxHeight:0>a&&(i.sc.scrollTop=a+l)}else i.sc.scrollTop=0}},o(window,"resize",i.updateSC),document.body.appendChild(i.sc),c(i.sc,"mouseleave","autocomplete-suggestion",function(e){var t=i.sc.querySelector(".autocomplete-suggestion.selected");t&&setTimeout(function(){t.className=t.className.replace("selected","")},20)}),c(i.sc,"mouseover","autocomplete-suggestion",function(e){var t=i.sc.querySelector(".autocomplete-suggestion.selected");t&&(t.className=t.className.replace("selected","")),this.className+=" selected"}),c(i.sc,"mouseup","autocomplete-suggestion",function(e){if(~this.className.indexOf("autocomplete-suggestion")){var t=this.getAttribute("data-val");i.value=t,s.onSelect(e,t,this),i.focus(),i.sc.style.display="none"}}),i.blurHandler=function(){try{var e=document.querySelector(".autocomplete-suggestions:hover")}catch(t){var e=0}e?i.focus():(i.last_val=i.value,i.sc.style.display="none")},o(i,"blur",i.blurHandler),i.focusHandler=function(){i.last_val="\n",t(i,"keyup")},s.minChars||o(i,"focus",i.focusHandler);var r=function(e){var t=i.value;if(i.cache[t]=e,e.length&&t.length>=s.minChars){for(var o="",n=0;n<e.length;n++)o+=s.renderItem(e[n],t);i.sc.innerHTML=o,i.updateSC(0)}else i.sc.style.display="none"};i.keydownHandler=function(e){var t=window.event?e.keyCode:e.which;if((40==t||38==t)&&i.sc.innerHTML){var o,n=i.sc.querySelector(".autocomplete-suggestion.selected");return n?(o=40==t?n.nextSibling:n.previousSibling,o?(n.className=n.className.replace("selected",""),o.className+=" selected",i.value=o.getAttribute("data-val")):(n.className=n.className.replace("selected",""),i.value=i.last_val,o=0)):(o=40==t?i.sc.querySelector(".autocomplete-suggestion"):i.sc.childNodes[i.sc.childNodes.length-1],o.className+=" selected",i.value=o.getAttribute("data-val")),i.updateSC(0,o),!1}if(27==t)i.value=i.last_val,i.sc.style.display="none";else if(13==t){var n=i.sc.querySelector(".autocomplete-suggestion.selected");n&&(s.onSelect(e,n.getAttribute("data-val"),n),setTimeout(function(){i.focus(),i.sc.style.display="none"},10))}},o(i,"keydown",i.keydownHandler),i.keyupHandler=function(e){var t=window.event?e.keyCode:e.which;if(27!=t&&38!=t&&40!=t&&37!=t&&39!=t){var o=i.value;if(o.length>=s.minChars){if(o!=i.last_val){if(i.last_val=o,clearTimeout(i.timer),s.cache){if(o in i.cache)return void r(i.cache[o]);for(var n=1;n<o.length-s.minChars;n++){var c=o.slice(0,o.length-n);if(c in i.cache&&!i.cache[c].length)return void r([])}}i.timer=setTimeout(function(){s.source(o,r)},s.delay)}}else i.last_val=o,i.sc.style.display="none"}},o(i,"keyup",i.keyupHandler)}this.destroy=function(){for(var e=0;e<a.length;e++){var t=a[e];n(window,"resize",t.updateSC),n(t,"blur",t.blurHandler),n(t,"focus",t.focusHandler),n(t,"keydown",t.keydownHandler),n(t,"keyup",t.keyupHandler),t.autocompleteAttr?t.setAttribute("autocomplete",t.autocompleteAttr):t.removeAttribute("autocomplete"),document.body.removeChild(t.sc),t=null}}}}return e}();!function(){"function"==typeof define&&define.amd?define("autoComplete",function(){return autoComplete}):"undefined"!=typeof module&&module.exports?module.exports=autoComplete:window.autoComplete=autoComplete}();